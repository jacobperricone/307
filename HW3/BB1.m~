function [ x, x0 ] = BB1(f, df, x_initial, x0_intial, a, b, MAX_ITER, TOL, debug, one)

    x = x_initial;
    x0 = x0_intial;
    
    x_cat_prev = [x; x0];
    
    iter = 1;
    fvals = [];
    fvals(iter) = f(x,x0, a,b);
    
    
    
    x_initial = [0;0;0];
    
    delta_x = x_cat_prev 
    delta_g = df(x,x0,a,b) - df(x_initial(1:end-1), x_initial(end), a, b)
    
    
    

    delta_f = 1000;
   
   
    if debug
            disp(sprintf('-----------------------Iteration: %d--------------------------------', iter));
            disp('     x_1        x_2        x_0     f(x)   change_F  delta_x1  delta_x2   delta_x0   delta_g1  deltag2   deltag3   alpha ')
            disp([  x(1), x(2), x0, fvals(iter), NaN, delta_x(1), delta_x(2), delta_x(3), delta_g(1), delta_g(2), delta_g(3), NaN ])
            
    end
    
   
    while iter < MAX_ITER 
         
        if abs(delta_f) < TOL
            disp(sprintf('CONVERGENCE OF FUNCTION AFTER %d ITERATIONS', iter))
            break;
        end
        
        iter = iter + 1;
        
        alpha_k_1 = (delta_x'*delta_g)/(delta_g'*delta_g);
        alpha_k_2 = (delta_x'*delta_x)/(delta_x'*delta_g);
        
        
        if one
            alpha = alpha_k_1
        else
            alpha = alpha_k_2
        end
        
        x_cat_new = x_cat_prev - alpha*df(x,x0, a, b);
        x = x_cat_new(1:end-1);
        
        x0 = x_cat_new(end);
        
        fvals(iter) = f(x,x0, a, b); 
        
        
        
        delta_f = fvals(iter) - fvals(iter - 1); 
        norm_grad = norm(df(x,x0,a,b)
        
       

        if debug
            disp(sprintf('-----------------------Iteration: %d--------------------------------', iter));
            disp('     x_1        x_2        x_0     f(x)   change_F  delta_x1  delta_x2   delta_x0   delta_g1  deltag2   deltag3   alpha ')
            disp([ x(1), x(2), x0, fvals(iter), delta_f,  delta_x(1), delta_x(2), delta_x(3), delta_g(1), delta_g(2), delta_g(3), alpha ])
            
        end
        
        delta_x =  x_cat_new - x_cat_prev;
        delta_g = df(x, x0, a, b) - df(x_cat_prev(1:end-1), x_cat_prev(end), a, b);
        x_cat_prev = x_cat_new;
        
        
    end
    
    figure(); 
    plot(1:iter, fvals, 'LineWidth',2); grid on;
    title('Objective Function SDM'); xlabel('Iteration'); ylabel('F(x)');
    
    

end

